
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Temporal Fusion Transformer &#8212; darts  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="shortcut icon" href="../_static/docs-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Filtering and predicting using the darts filters" href="10-Kalman-filter-examples.html" />
    <link rel="prev" title="DeepTCN model" href="09-DeepTCN-examples.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/darts-logo-trim.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../README.html">
  Home
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../quickstart/00-quickstart.html">
  Quickstart
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../userguide.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../generated_api/darts.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../examples.html">
  Examples
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/unit8co/darts" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/unit8co" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01-multi-time-series-and-covariates.html">
   Multiple Time Series, Pre-trained Models and Covariates
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="02-data-processing.html">
   Data (pre) processing using
   <code class="docutils literal notranslate">
    <span class="pre">
     DataTransformer
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     Pipeline
    </span>
   </code>
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="15-static-covariates.html">
   Static Covariates
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="14-transfer-learning.html">
   Transfer Learning for Time Series Forecasting with Darts
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="16-hierarchical-reconciliation.html">
   Hierarchical Reconciliation - Example on the Australian Tourism Dataset
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="17-hyperparameter-optimization.html">
   Hyper-parameters Optimization for Electricity Load Forecasting
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="03-FFT-examples.html">
   Fast Fourier Transform Forecasting Model (FFT)
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="04-RNN-examples.html">
   Recurrent Neural Networks Models
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="05-TCN-examples.html">
   Temporal Convolutional Network
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="06-Transformer-examples.html">
   Transformer Model
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="07-NBEATS-examples.html">
   N-BEATS
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="08-DeepAR-examples.html">
   Probabilistic RNN
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="09-DeepTCN-examples.html">
   DeepTCN model
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Temporal Fusion Transformer
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="10-Kalman-filter-examples.html">
   Filtering and predicting using the darts filters
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="11-GP-filter-examples.html">
   Filtering and predicting using the Gaussian Process filter
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="12-Dynamic-Time-Warping-example.html">
   Dynamic Time Warping (DTW)
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Temporal-Fusion-Transformer-(TFT)">
   Temporal Fusion Transformer (TFT)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Training">
     Training
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Forecast">
     Forecast
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Probabilistic-Forecast">
       Probabilistic Forecast
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Deterministic-Forecast">
       Deterministic Forecast
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Air-Passenger-Example">
   Air Passenger Example
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Create-a-model">
     Create a model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Train-the-TFT">
     Train the TFT
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Look-at-predictions-on-the-validation-set">
     Look at predictions on the validation set
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Backtesting">
     Backtesting
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Monthly-ice-cream-sales">
   Monthly ice cream sales
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Process-the-data">
     Process the data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Create-a-model-with-automatically-generated-future-covariates-and-train-it">
     Create a model with automatically generated future covariates and train it
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Look at predictions on the validation set
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Backtesting
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Temporal-Fusion-Transformer">
<h1>Temporal Fusion Transformer<a class="headerlink" href="#Temporal-Fusion-Transformer" title="Permalink to this headline">¶</a></h1>
<p>In this notebook, we show two examples of how two use Darts’ <code class="docutils literal notranslate"><span class="pre">TFTModel</span></code>. If you are new to darts, we recommend you first follow the <a class="reference external" href="https://unit8co.github.io/darts/quickstart/00-quickstart.html">quick start</a> notebook.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># fix python path if working locally</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">fix_pythonpath_if_working_locally</span>

<span class="n">fix_pythonpath_if_working_locally</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm_notebook</span> <span class="k">as</span> <span class="n">tqdm</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">darts</span> <span class="kn">import</span> <span class="n">TimeSeries</span><span class="p">,</span> <span class="n">concatenate</span>
<span class="kn">from</span> <span class="nn">darts.dataprocessing.transformers</span> <span class="kn">import</span> <span class="n">Scaler</span>
<span class="kn">from</span> <span class="nn">darts.models</span> <span class="kn">import</span> <span class="n">TFTModel</span>
<span class="kn">from</span> <span class="nn">darts.metrics</span> <span class="kn">import</span> <span class="n">mape</span>
<span class="kn">from</span> <span class="nn">darts.utils.statistics</span> <span class="kn">import</span> <span class="n">check_seasonality</span><span class="p">,</span> <span class="n">plot_acf</span>
<span class="kn">from</span> <span class="nn">darts.datasets</span> <span class="kn">import</span> <span class="n">AirPassengersDataset</span><span class="p">,</span> <span class="n">IceCreamHeaterDataset</span>
<span class="kn">from</span> <span class="nn">darts.utils.timeseries_generation</span> <span class="kn">import</span> <span class="n">datetime_attribute_timeseries</span>
<span class="kn">from</span> <span class="nn">darts.utils.likelihood_models</span> <span class="kn">import</span> <span class="n">QuantileRegression</span>

<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Temporal-Fusion-Transformer-(TFT)">
<h2>Temporal Fusion Transformer (TFT)<a class="headerlink" href="#Temporal-Fusion-Transformer-(TFT)" title="Permalink to this headline">¶</a></h2>
<p>Darts’ <code class="docutils literal notranslate"><span class="pre">TFTModel</span></code> incorporates the following main components from the original Temporal Fusion Transformer (TFT) architecture as outlined in <a class="reference external" href="https://arxiv.org/pdf/1912.09363.pdf">this paper</a>:</p>
<ul class="simple">
<li><p>gating mechanisms: skip over unused components of the model architecture</p></li>
<li><p>variable selection networks: select relevant input variables at each time step.</p></li>
<li><p>temporal processing of past and future input with LSTMs (long short-term memory)</p></li>
<li><p>multi-head attention: captures long-term temporal dependencies</p></li>
<li><p>prediction intervals: per default, produces quantile forecasts instead of deterministic values</p></li>
</ul>
<section id="Training">
<h3>Training<a class="headerlink" href="#Training" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">TFTModel</span></code> can be trained with past and future covariates. It is trained sequentially on fixed-size chunks consisting of an encoder and a decoder part:</p>
<ul class="simple">
<li><p>encoder: past input with <code class="docutils literal notranslate"><span class="pre">input_chunk_length</span></code></p>
<ul>
<li><p><strong>past target</strong>: mandatory</p></li>
<li><p><strong>past covariates</strong>: optional</p></li>
</ul>
</li>
<li><p>decoder: future known input with <code class="docutils literal notranslate"><span class="pre">output_chunk_length</span></code></p>
<ul>
<li><p><strong>future covariates</strong>: mandatory (if none are available, consider <code class="docutils literal notranslate"><span class="pre">TFTModel</span></code>’s optional arguments <code class="docutils literal notranslate"><span class="pre">add_encoders</span></code> or <code class="docutils literal notranslate"><span class="pre">add_relative_index</span></code> from <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.tft_model.html?highlight=tftmodel#temporal-fusion-transformer-tft">here</a>)</p></li>
</ul>
</li>
</ul>
<p>In each iteration, the model produces a quantile prediction of shape <code class="docutils literal notranslate"><span class="pre">(output_chunk_length,</span> <span class="pre">n_quantiles)</span></code> on the decoder part.</p>
</section>
<section id="Forecast">
<h3>Forecast<a class="headerlink" href="#Forecast" title="Permalink to this headline">¶</a></h3>
<section id="Probabilistic-Forecast">
<h4>Probabilistic Forecast<a class="headerlink" href="#Probabilistic-Forecast" title="Permalink to this headline">¶</a></h4>
<p>Per default, <code class="docutils literal notranslate"><span class="pre">TFTModel</span></code> produces probabilistic quantile forecasts using <code class="docutils literal notranslate"><span class="pre">QuantileRegression</span></code>. This gives the range of likely target values at each prediction step. Most deep learning models in Darts’ - including <code class="docutils literal notranslate"><span class="pre">TFTModel</span></code> - support <code class="docutils literal notranslate"><span class="pre">QuantileRegression</span></code> and 16 other likelihoods to produce probabilistic forecasts by setting <code class="docutils literal notranslate"><span class="pre">likelihood=MyLikelihood()</span></code> at model creation.</p>
<p>To produce meaningful results, set <code class="docutils literal notranslate"><span class="pre">num_samples</span> <span class="pre">&gt;&gt;</span> <span class="pre">1</span></code> when predicting. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>model.predict(*args, **kwargs, num_samples=200)
</pre></div>
</div>
<p>Predictions with forecasting horizon <code class="docutils literal notranslate"><span class="pre">n</span></code> are generated auto-regressively using encoder-decoder chunks of the same size as during training.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&gt;</span> <span class="pre">output_chunk_length</span></code>, you have to supply additional future values for the covariates you passed to <code class="docutils literal notranslate"><span class="pre">model.train()</span></code>.</p>
</section>
<section id="Deterministic-Forecast">
<h4>Deterministic Forecast<a class="headerlink" href="#Deterministic-Forecast" title="Permalink to this headline">¶</a></h4>
<p>To produce deterministic rather than probabilistic forecasts, set parameter <code class="docutils literal notranslate"><span class="pre">likelihood</span></code> to <code class="docutils literal notranslate"><span class="pre">None</span></code> and <code class="docutils literal notranslate"><span class="pre">loss_fn</span></code> to a PyTorch loss function at model creation. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>model = TFTModel(*args, **kwargs, likelihood=None, loss_fn=torch.nn.MSELoss())
...
model.predict(*args, **kwargs, num_samples=1)
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># before starting, we define some constants</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">200</span>

<span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">lowest_q</span><span class="p">,</span> <span class="n">low_q</span><span class="p">,</span> <span class="n">high_q</span><span class="p">,</span> <span class="n">highest_q</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.99</span>
<span class="n">label_q_outer</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">lowest_q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">highest_q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">th percentiles&quot;</span>
<span class="n">label_q_inner</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">low_q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">high_q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">th percentiles&quot;</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="Air-Passenger-Example">
<h2>Air Passenger Example<a class="headerlink" href="#Air-Passenger-Example" title="Permalink to this headline">¶</a></h2>
<p>This data set that is highly dependent on covariates. Knowing the month tells us a lot about the seasonal component, whereas the year determines the effect of the trend component.</p>
<p>Additionally, let’s convert the time index to integer values and use them as covariates as well.</p>
<p>All of the three covariates are known in the future, and can be used as <code class="docutils literal notranslate"><span class="pre">future_covariates</span></code> with the <code class="docutils literal notranslate"><span class="pre">TFTModel</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Read data</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">AirPassengersDataset</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="c1"># we convert monthly number of passengers to average daily number of passengers per month</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">series</span> <span class="o">/</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">from_series</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">time_index</span><span class="o">.</span><span class="n">days_in_month</span><span class="p">)</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Create training and validation sets:</span>
<span class="n">training_cutoff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;19571201&quot;</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">split_after</span><span class="p">(</span><span class="n">training_cutoff</span><span class="p">)</span>

<span class="c1"># Normalize the time series (note: we avoid fitting the transformer on the validation set)</span>
<span class="n">transformer</span> <span class="o">=</span> <span class="n">Scaler</span><span class="p">()</span>
<span class="n">train_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">val_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<span class="n">series_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

<span class="c1"># create year, month and integer index covariate series</span>
<span class="n">covariates</span> <span class="o">=</span> <span class="n">datetime_attribute_timeseries</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">one_hot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">covariates</span> <span class="o">=</span> <span class="n">covariates</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
    <span class="n">datetime_attribute_timeseries</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">one_hot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">covariates</span> <span class="o">=</span> <span class="n">covariates</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
    <span class="n">TimeSeries</span><span class="o">.</span><span class="n">from_times_and_values</span><span class="p">(</span>
        <span class="n">times</span><span class="o">=</span><span class="n">series</span><span class="o">.</span><span class="n">time_index</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)),</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;linear_increase&quot;</span><span class="p">],</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">covariates</span> <span class="o">=</span> <span class="n">covariates</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># transform covariates (note: we fit the transformer on train split and can then transform the entire covariates series)</span>
<span class="n">scaler_covs</span> <span class="o">=</span> <span class="n">Scaler</span><span class="p">()</span>
<span class="n">cov_train</span><span class="p">,</span> <span class="n">cov_val</span> <span class="o">=</span> <span class="n">covariates</span><span class="o">.</span><span class="n">split_after</span><span class="p">(</span><span class="n">training_cutoff</span><span class="p">)</span>
<span class="n">scaler_covs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_train</span><span class="p">)</span>
<span class="n">covariates_transformed</span> <span class="o">=</span> <span class="n">scaler_covs</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">covariates</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Create-a-model">
<h3>Create a model<a class="headerlink" href="#Create-a-model" title="Permalink to this headline">¶</a></h3>
<p>If you want to produce deterministic forecasts rather than quantile forecasts, you can use a PyTorch loss function (i.e., set <code class="docutils literal notranslate"><span class="pre">loss_fn=torch.nn.MSELoss()</span></code> and <code class="docutils literal notranslate"><span class="pre">likelihood=None</span></code>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">TFTModel</span></code> can only be used if some future input is given. Optional parameters <code class="docutils literal notranslate"><span class="pre">add_encoders</span></code> and <code class="docutils literal notranslate"><span class="pre">add_relative_index</span></code> can be useful, especially if we don’t have any future input available. They generate encoded temporal data that is used as future covariates.</p>
<p>Since we already have future covariates defined in our example they are commented out.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># default quantiles for QuantileRegression</span>
<span class="n">quantiles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.01</span><span class="p">,</span>
    <span class="mf">0.05</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="mf">0.15</span><span class="p">,</span>
    <span class="mf">0.2</span><span class="p">,</span>
    <span class="mf">0.25</span><span class="p">,</span>
    <span class="mf">0.3</span><span class="p">,</span>
    <span class="mf">0.4</span><span class="p">,</span>
    <span class="mf">0.5</span><span class="p">,</span>
    <span class="mf">0.6</span><span class="p">,</span>
    <span class="mf">0.7</span><span class="p">,</span>
    <span class="mf">0.75</span><span class="p">,</span>
    <span class="mf">0.8</span><span class="p">,</span>
    <span class="mf">0.85</span><span class="p">,</span>
    <span class="mf">0.9</span><span class="p">,</span>
    <span class="mf">0.95</span><span class="p">,</span>
    <span class="mf">0.99</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">input_chunk_length</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">forecast_horizon</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">my_model</span> <span class="o">=</span> <span class="n">TFTModel</span><span class="p">(</span>
    <span class="n">input_chunk_length</span><span class="o">=</span><span class="n">input_chunk_length</span><span class="p">,</span>
    <span class="n">output_chunk_length</span><span class="o">=</span><span class="n">forecast_horizon</span><span class="p">,</span>
    <span class="n">hidden_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
    <span class="n">lstm_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">num_attention_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">dropout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">n_epochs</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">add_relative_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">add_encoders</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">likelihood</span><span class="o">=</span><span class="n">QuantileRegression</span><span class="p">(</span>
        <span class="n">quantiles</span><span class="o">=</span><span class="n">quantiles</span>
    <span class="p">),</span>  <span class="c1"># QuantileRegression is set per default</span>
    <span class="c1"># loss_fn=MSELoss(),</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Train-the-TFT">
<h3>Train the TFT<a class="headerlink" href="#Train-the-TFT" title="Permalink to this headline">¶</a></h3>
<p>In what follows, we can just provide the whole <code class="docutils literal notranslate"><span class="pre">covariates</span></code> series as <code class="docutils literal notranslate"><span class="pre">future_covariates</span></code> argument to the model; the model will slice these covariates and use only what it needs in order to train on forecasting the target <code class="docutils literal notranslate"><span class="pre">train_transformed</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">my_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_transformed</span><span class="p">,</span> <span class="n">future_covariates</span><span class="o">=</span><span class="n">covariates_transformed</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "fe7b9ff3dda44e418b3ca62eb7835520", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Training loss: 0.0549
</pre></div></div>
</div>
</section>
<section id="Look-at-predictions-on-the-validation-set">
<h3>Look at predictions on the validation set<a class="headerlink" href="#Look-at-predictions-on-the-validation-set" title="Permalink to this headline">¶</a></h3>
<p>We perform a one-shot prediction of 24 months using the “current” model - i.e., the model at the end of the training procedure:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">eval_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">actual_series</span><span class="p">,</span> <span class="n">val_series</span><span class="p">):</span>
    <span class="n">pred_series</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">)</span>

    <span class="c1"># plot actual series</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">actual_series</span><span class="p">[:</span> <span class="n">pred_series</span><span class="o">.</span><span class="n">end_time</span><span class="p">()]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual&quot;</span><span class="p">)</span>

    <span class="c1"># plot prediction with quantile ranges</span>
    <span class="n">pred_series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">low_quantile</span><span class="o">=</span><span class="n">lowest_q</span><span class="p">,</span> <span class="n">high_quantile</span><span class="o">=</span><span class="n">highest_q</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_q_outer</span>
    <span class="p">)</span>
    <span class="n">pred_series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">low_quantile</span><span class="o">=</span><span class="n">low_q</span><span class="p">,</span> <span class="n">high_quantile</span><span class="o">=</span><span class="n">high_q</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_q_inner</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;MAPE: </span><span class="si">{:.2f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mape</span><span class="p">(</span><span class="n">val_series</span><span class="p">,</span> <span class="n">pred_series</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">eval_model</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="n">series_transformed</span><span class="p">,</span> <span class="n">val_transformed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_13-TFT-examples_13_0.png" src="../_images/examples_13-TFT-examples_13_0.png" />
</div>
</div>
</section>
<section id="Backtesting">
<h3>Backtesting<a class="headerlink" href="#Backtesting" title="Permalink to this headline">¶</a></h3>
<p>Let’s backtest our <code class="docutils literal notranslate"><span class="pre">TFTModel</span></code> model, to see how it performs with a forecast horizon of 12 months over the last 3 years:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">backtest_series</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span>
    <span class="n">series_transformed</span><span class="p">,</span>
    <span class="n">future_covariates</span><span class="o">=</span><span class="n">covariates_transformed</span><span class="p">,</span>
    <span class="n">start</span><span class="o">=</span><span class="n">train</span><span class="o">.</span><span class="n">end_time</span><span class="p">()</span> <span class="o">+</span> <span class="n">train</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span>
    <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
    <span class="n">forecast_horizon</span><span class="o">=</span><span class="n">forecast_horizon</span><span class="p">,</span>
    <span class="n">stride</span><span class="o">=</span><span class="n">forecast_horizon</span><span class="p">,</span>
    <span class="n">last_points_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">retrain</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "307d0dd38ec74d7e89e980af4ef48363", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">eval_backtest</span><span class="p">(</span><span class="n">backtest_series</span><span class="p">,</span> <span class="n">actual_series</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">transformer</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">actual_series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual&quot;</span><span class="p">)</span>
    <span class="n">backtest_series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">low_quantile</span><span class="o">=</span><span class="n">lowest_q</span><span class="p">,</span> <span class="n">high_quantile</span><span class="o">=</span><span class="n">highest_q</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_q_outer</span>
    <span class="p">)</span>
    <span class="n">backtest_series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">low_quantile</span><span class="o">=</span><span class="n">low_q</span><span class="p">,</span> <span class="n">high_quantile</span><span class="o">=</span><span class="n">high_q</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_q_inner</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Backtest, starting </span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">horizon</span><span class="si">}</span><span class="s2">-months horizon&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;MAPE: </span><span class="si">{:.2f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">mape</span><span class="p">(</span>
                <span class="n">transformer</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">actual_series</span><span class="p">),</span>
                <span class="n">transformer</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">backtest_series</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>


<span class="n">eval_backtest</span><span class="p">(</span>
    <span class="n">backtest_series</span><span class="o">=</span><span class="n">concatenate</span><span class="p">(</span><span class="n">backtest_series</span><span class="p">),</span>
    <span class="n">actual_series</span><span class="o">=</span><span class="n">series_transformed</span><span class="p">,</span>
    <span class="n">horizon</span><span class="o">=</span><span class="n">forecast_horizon</span><span class="p">,</span>
    <span class="n">start</span><span class="o">=</span><span class="n">training_cutoff</span><span class="p">,</span>
    <span class="n">transformer</span><span class="o">=</span><span class="n">transformer</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE: 5.24%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_13-TFT-examples_16_1.png" src="../_images/examples_13-TFT-examples_16_1.png" />
</div>
</div>
</section>
</section>
<section id="Monthly-ice-cream-sales">
<h2>Monthly ice cream sales<a class="headerlink" href="#Monthly-ice-cream-sales" title="Permalink to this headline">¶</a></h2>
<p>Let’s try a another data set. That of monthly ice cream and heater sales since 2004. Our target is to predict future ice cream sales. First, we build the time series from the data, and check its periodicity.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">series_ice_heater</span> <span class="o">=</span> <span class="n">IceCreamHeaterDataset</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">series_ice_heater</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">check_seasonality</span><span class="p">(</span><span class="n">series_ice_heater</span><span class="p">[</span><span class="s2">&quot;ice cream&quot;</span><span class="p">],</span> <span class="n">max_lag</span><span class="o">=</span><span class="mi">36</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">check_seasonality</span><span class="p">(</span><span class="n">series_ice_heater</span><span class="p">[</span><span class="s2">&quot;heater&quot;</span><span class="p">],</span> <span class="n">max_lag</span><span class="o">=</span><span class="mi">36</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">series_ice_heater</span><span class="p">[</span><span class="s2">&quot;ice cream&quot;</span><span class="p">],</span> <span class="mi">12</span><span class="p">,</span> <span class="n">max_lag</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>  <span class="c1"># ~1 year seasonality</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(True, 12)
(True, 12)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_13-TFT-examples_18_1.png" src="../_images/examples_13-TFT-examples_18_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Figure size 648x432 with 0 Axes&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_13-TFT-examples_18_3.png" src="../_images/examples_13-TFT-examples_18_3.png" />
</div>
</div>
<section id="Process-the-data">
<h3>Process the data<a class="headerlink" href="#Process-the-data" title="Permalink to this headline">¶</a></h3>
<p>We again have a 12-month seasonality. This time we will not define monthly future covariates -&gt; we let the model handle this itself!</p>
<p>Let’s define past covariates instead. What if we used past data of heater sales to predict ice cream sales?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># convert monthly sales to average daily sales per month</span>
<span class="n">converted_series</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ice cream&quot;</span><span class="p">,</span> <span class="s2">&quot;heater&quot;</span><span class="p">]:</span>
    <span class="n">converted_series</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">series_ice_heater</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
        <span class="o">/</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">from_series</span><span class="p">(</span><span class="n">series_ice_heater</span><span class="o">.</span><span class="n">time_index</span><span class="o">.</span><span class="n">days_in_month</span><span class="p">)</span>
    <span class="p">)</span>
<span class="n">converted_series</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span><span class="n">converted_series</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">converted_series</span> <span class="o">=</span> <span class="n">converted_series</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;20100101&quot;</span><span class="p">)</span> <span class="p">:]</span>

<span class="c1"># define train/validation cutoff time</span>
<span class="n">forecast_horizon_ice</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">training_cutoff_ice</span> <span class="o">=</span> <span class="n">converted_series</span><span class="o">.</span><span class="n">time_index</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">forecast_horizon_ice</span><span class="p">)]</span>

<span class="c1"># use ice cream sales as target, create train and validation sets and transform data</span>
<span class="n">series_ice</span> <span class="o">=</span> <span class="n">converted_series</span><span class="p">[</span><span class="s2">&quot;ice cream&quot;</span><span class="p">]</span>
<span class="n">train_ice</span><span class="p">,</span> <span class="n">val_ice</span> <span class="o">=</span> <span class="n">series_ice</span><span class="o">.</span><span class="n">split_before</span><span class="p">(</span><span class="n">training_cutoff_ice</span><span class="p">)</span>
<span class="n">transformer_ice</span> <span class="o">=</span> <span class="n">Scaler</span><span class="p">()</span>
<span class="n">train_ice_transformed</span> <span class="o">=</span> <span class="n">transformer_ice</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_ice</span><span class="p">)</span>
<span class="n">val_ice_transformed</span> <span class="o">=</span> <span class="n">transformer_ice</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">val_ice</span><span class="p">)</span>
<span class="n">series_ice_transformed</span> <span class="o">=</span> <span class="n">transformer_ice</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">series_ice</span><span class="p">)</span>

<span class="c1"># use heater sales as past covariates and transform data</span>
<span class="n">covariates_heat</span> <span class="o">=</span> <span class="n">converted_series</span><span class="p">[</span><span class="s2">&quot;heater&quot;</span><span class="p">]</span>
<span class="n">cov_heat_train</span><span class="p">,</span> <span class="n">cov_heat_val</span> <span class="o">=</span> <span class="n">covariates_heat</span><span class="o">.</span><span class="n">split_before</span><span class="p">(</span><span class="n">training_cutoff_ice</span><span class="p">)</span>
<span class="n">transformer_heat</span> <span class="o">=</span> <span class="n">Scaler</span><span class="p">()</span>
<span class="n">transformer_heat</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_heat_train</span><span class="p">)</span>
<span class="n">covariates_heat_transformed</span> <span class="o">=</span> <span class="n">transformer_heat</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">covariates_heat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Create-a-model-with-automatically-generated-future-covariates-and-train-it">
<h3>Create a model with automatically generated future covariates and train it<a class="headerlink" href="#Create-a-model-with-automatically-generated-future-covariates-and-train-it" title="Permalink to this headline">¶</a></h3>
<p>Since we don’t have future covariates defined, we need tell the model to generate future covariates itself.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">add_encoders</span></code>: can add multiple encodings as past and / or future covariates from datetime attributes, cyclic repeating temporal patterns, index positions and customm functions for index encodings. You can even add a transformer that handles proper scaling of the training, validation and prediction data! Read more about it in the <code class="docutils literal notranslate"><span class="pre">TFTModel</span></code> docs <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.tft_model.html#temporal-fusion-transformer-tft">from here</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">add_relative_index</span></code>: adds a scaled integer position relative to the prediction point for each encoder-decoder chunk (this might be useful if you really don’t want to use any future covariates. The position values remain constant over all chunks and do not add additional information).</p></li>
</ul>
<p>We use <code class="docutils literal notranslate"><span class="pre">add_encoders={'cyclic':</span> <span class="pre">{'future':</span> <span class="pre">['month']}}</span></code> to account for the 12-month seasonality as a future covariate..</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># use the last 3 years as past input data</span>
<span class="n">input_chunk_length_ice</span> <span class="o">=</span> <span class="mi">36</span>

<span class="c1"># use `add_encoders` as we don&#39;t have future covariates</span>
<span class="n">my_model_ice</span> <span class="o">=</span> <span class="n">TFTModel</span><span class="p">(</span>
    <span class="n">input_chunk_length</span><span class="o">=</span><span class="n">input_chunk_length_ice</span><span class="p">,</span>
    <span class="n">output_chunk_length</span><span class="o">=</span><span class="n">forecast_horizon_ice</span><span class="p">,</span>
    <span class="n">hidden_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">lstm_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">n_epochs</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">dropout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">add_encoders</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cyclic&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]}},</span>
    <span class="n">add_relative_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">optimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">},</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># fit the model with past covariates</span>
<span class="n">my_model_ice</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_ice_transformed</span><span class="p">,</span> <span class="n">past_covariates</span><span class="o">=</span><span class="n">covariates_heat_transformed</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "04cf171092ad4ef88b3ec52ee3636aa8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Training loss: 0.1257
</pre></div></div>
</div>
</section>
<section id="id1">
<h3>Look at predictions on the validation set<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Again, we perform a one-shot prediction of 24 months using the “current” model - i.e., the model at the end of the training procedure:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">eval_model</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">my_model_ice</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
    <span class="n">actual_series</span><span class="o">=</span><span class="n">series_ice_transformed</span><span class="p">[</span>
        <span class="n">train_ice</span><span class="o">.</span><span class="n">end_time</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">train_ice</span><span class="o">.</span><span class="n">freq</span> <span class="p">:</span>
    <span class="p">],</span>
    <span class="n">val_series</span><span class="o">=</span><span class="n">val_ice_transformed</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_13-TFT-examples_24_0.png" src="../_images/examples_13-TFT-examples_24_0.png" />
</div>
</div>
</section>
<section id="id2">
<h3>Backtesting<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Let’s backtest our <code class="docutils literal notranslate"><span class="pre">TFTModel</span></code> model, to see how it performs with a forecast horizon of 12 months over the last 2 years:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Compute the backtest predictions with the two models</span>
<span class="n">last_points_only</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">backtest_series_ice</span> <span class="o">=</span> <span class="n">my_model_ice</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span>
    <span class="n">series_ice_transformed</span><span class="p">,</span>
    <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
    <span class="n">start</span><span class="o">=</span><span class="n">training_cutoff_ice</span><span class="p">,</span>
    <span class="n">forecast_horizon</span><span class="o">=</span><span class="n">forecast_horizon_ice</span><span class="p">,</span>
    <span class="n">stride</span><span class="o">=</span><span class="mi">1</span> <span class="k">if</span> <span class="n">last_points_only</span> <span class="k">else</span> <span class="n">forecast_horizon_ice</span><span class="p">,</span>
    <span class="n">retrain</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">last_points_only</span><span class="o">=</span><span class="n">last_points_only</span><span class="p">,</span>
    <span class="n">overlap_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">backtest_series_ice</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">concatenate</span><span class="p">(</span><span class="n">backtest_series_ice</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backtest_series_ice</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">else</span> <span class="n">backtest_series_ice</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b02a42ed4dcc4420809f54452f8b2ed7", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eval_backtest</span><span class="p">(</span>
    <span class="n">backtest_series</span><span class="o">=</span><span class="n">backtest_series_ice</span><span class="p">,</span>
    <span class="n">actual_series</span><span class="o">=</span><span class="n">series_ice_transformed</span><span class="p">[</span>
        <span class="n">train_ice</span><span class="o">.</span><span class="n">start_time</span><span class="p">()</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">forecast_horizon_ice</span> <span class="o">*</span> <span class="n">train_ice</span><span class="o">.</span><span class="n">freq</span> <span class="p">:</span>
    <span class="p">],</span>
    <span class="n">horizon</span><span class="o">=</span><span class="n">forecast_horizon_ice</span><span class="p">,</span>
    <span class="n">start</span><span class="o">=</span><span class="n">training_cutoff_ice</span><span class="p">,</span>
    <span class="n">transformer</span><span class="o">=</span><span class="n">transformer_ice</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE: 4.26%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_13-TFT-examples_27_1.png" src="../_images/examples_13-TFT-examples_27_1.png" />
</div>
</div>
</section>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="09-DeepTCN-examples.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">DeepTCN model</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="10-Kalman-filter-examples.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Filtering and predicting using the darts filters</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020 - 2023, Unit8 SA (Apache 2.0 License).<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.2.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>