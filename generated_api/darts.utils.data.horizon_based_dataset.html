
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Horizon-Based Training Dataset &#8212; darts  documentation</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sequential Training Dataset" href="darts.utils.data.sequential_dataset.html" />
    <link rel="prev" title="TimeSeries Datasets" href="darts.utils.data.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../index.html">
    
      <img src="../_static/darts-logo-trim.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../README.html">Home</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="darts.html">API Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../examples.html">Examples</a>
        </li>
        
        
      </ul>


      <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/unit8co/darts" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/unit8co" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
          
            
                <li class="">
                    <a href="darts.dataprocessing.html">Data Processing</a>
                </li>
            
          
            
                <li class="">
                    <a href="darts.metrics.html">Metrics</a>
                </li>
            
          
            
                <li class="">
                    <a href="darts.models.html">Models</a>
                </li>
            
          
            
  
                <li class="active">
                    <a href="darts.utils.html">Utils</a>
                    <ul>
                    
                        <li class="active">
                            <a href="darts.utils.data.html">TimeSeries Datasets</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.utils.missing_values.html">Utils for filling missing values</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.utils.statistics.html">Utils for time series statistics</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.utils.timeseries_generation.html">Utils for time series generation</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.utils.torch.html">Utils for Pytorch and its usage</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.utils.utils.html">Additional util functions</a>
                        </li>
                    
                    </ul>
                </li>
            
          
            
                <li class="">
                    <a href="darts.timeseries.html">Timeseries</a>
                </li>
            
          
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <span class="target" id="module-darts.utils.data.horizon_based_dataset"></span><section id="horizon-based-training-dataset">
<h1>Horizon-Based Training Dataset<a class="headerlink" href="#horizon-based-training-dataset" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="darts.utils.data.horizon_based_dataset.HorizonBasedDataset">
<em class="property">class </em><code class="sig-prename descclassname">darts.utils.data.horizon_based_dataset.</code><code class="sig-name descname">HorizonBasedDataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/utils/data/horizon_based_dataset.html#HorizonBasedDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#darts.utils.data.horizon_based_dataset.HorizonBasedDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="darts.utils.data.timeseries_dataset.html#darts.utils.data.timeseries_dataset.TrainingDataset" title="darts.utils.data.timeseries_dataset.TrainingDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">darts.utils.data.timeseries_dataset.TrainingDataset</span></code></a></p>
<p>A time series dataset containing tuples of (input, output, input_covariates) arrays, in a way inspired
by the N-BEATS way of training on the M4 dataset: <a class="reference external" href="https://arxiv.org/abs/1905.10437">https://arxiv.org/abs/1905.10437</a>.</p>
<p>The “input” and “input_covariates” have length <cite>lookback * output_chunk_length</cite>, and the “output” has length
<cite>output_chunk_length</cite>.</p>
<p>Given the horizon <cite>output_chunk_length</cite> of a model, this dataset will compute some (input, target) splits as follows
(the logic for “input_covariates” is the same as for “input”):
First a “forecast point” is selected in the the range of the last
<cite>(min_lh * output_chunk_length, max_lh * output_chunk_length)</cite> points before the end of the time series.
The target then consists in the following <cite>output_chunk_length</cite> points, and the data will be the preceding
<cite>lookback * output_chunk_length</cite> points.</p>
<p>All the series in the provided sequence must be long enough; i.e. have length at least
<cite>(lookback + max_lh) * output_chunk_length</cite>, and <cite>min_lh</cite> must be at least 1
(to have targets of length exactly <cite>1 * output_chunk_length</cite>).
The target and covariates time series are sliced together, and therefore must have the same length.
If these conditions are not satisfied, an error will be raised when trying to access some of the splits.</p>
<p>The sampling is uniform both over the number of time series and the number of samples per series;
i.e. the i-th sample of this dataset has 1/(N*M) chance of coming from any of the M samples in any of the N
time series in the sequence.</p>
<p>The recommended use of this class is to either build it from a list of <cite>TimeSeries</cite> (if all your series fit
in memory), or implement your own <cite>Sequence</cite> of time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_series</strong> – One or a sequence of target <cite>TimeSeries</cite>.</p></li>
<li><p><strong>covariates</strong> – Optionally, one or a sequence of <cite>TimeSeries</cite> containing covariates. If this parameter is set,
the provided sequence must have the same length as that of <cite>target_series</cite>.</p></li>
<li><p><strong>output_chunk_length</strong> – The length of the “output” series emitted by the model</p></li>
<li><p><strong>lh</strong> – A <cite>(min_lh, max_lh)</cite> interval for the forecast point, starting from the end of the series.
For example, <cite>(1, 3)</cite> will select forecast points uniformly between <cite>1*H</cite> and <cite>3*H</cite> points
before the end of the series. It is required that <cite>min_lh &gt;= 1</cite>.</p></li>
<li><p><strong>lookback</strong> – A integer interval for the length of the input in the emitted input and output splits, expressed as a
multiple of <cite>output_chunk_length</cite>. For instance, <cite>lookback=3</cite> will emit “inputs” of lengths <cite>3 * output_chunk_length</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="darts.utils.data.horizon_based_dataset.HorizonBasedDataset.count">
<code class="sig-name descname">count</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span> &#x2192; integer – return number of occurrences of value<a class="headerlink" href="#darts.utils.data.horizon_based_dataset.HorizonBasedDataset.count" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="darts.utils.data.horizon_based_dataset.HorizonBasedDataset.index">
<code class="sig-name descname">index</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="optional">[</span>, <em class="sig-param">start</em><span class="optional">[</span>, <em class="sig-param">stop</em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span> &#x2192; integer – return first index of value.<a class="headerlink" href="#darts.utils.data.horizon_based_dataset.HorizonBasedDataset.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises ValueError if the value is not present.</p>
<p>Supporting start and stop arguments is optional, but
recommended.</p>
</dd></dl>

</dd></dl>

</section>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="darts.utils.data.html" title="previous page">TimeSeries Datasets</a>
    <a class='right-next' id="next-link" href="darts.utils.data.sequential_dataset.html" title="next page">Sequential Training Dataset</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2021, Unit8 SA.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>